<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="robots" content="noindex,nofollow" />
  <title>Redirecting…</title>
  <style>
    :root { --fg:#111; --muted:#666; --bg:#fff; --btn:#0d6efd; }
    @media (prefers-color-scheme: dark) {
      :root { --fg:#eee; --muted:#aaa; --bg:#0b0b0b; --btn:#4da3ff; }
    }
    html,body{height:100%;margin:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--fg);display:flex;align-items:center;justify-content:center}
    .card{max-width:560px;width:92%;padding:24px 20px;border-radius:16px;border:1px solid #0001;box-shadow:0 10px 30px #0002}
    h1{font-size:20px;margin:0 0 6px}
    p{margin:6px 0;color:var(--muted)}
    .btns{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px}
    .btn{flex:1 1 220px;display:inline-block;padding:12px 14px;text-align:center;border-radius:12px;text-decoration:none;color:#fff;background:var(--btn)}
    .hint{margin-top:16px;font-size:12px;color:var(--muted)}
    .qr{margin-top:12px;display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .qr img{width:120px;height:120px;border-radius:8px;border:1px solid #0002}
    code{background:#0001;padding:2px 6px;border-radius:6px}
  </style>
</head>
<body>
  <main class="card">
    <h1 id="title">…</h1>
    <p id="status">…</p>

    <div class="btns">
      <a id="iosLink" class="btn" href="#" rel="nofollow"></a>
      <a id="androidLink" class="btn" href="#" rel="nofollow"></a>
    </div>

    <p id="hintAndroid" class="hint"></p>

    <div class="btns" id="extraBtns" style="display:none">
      <a id="androidApk" class="btn" href="#" rel="nofollow" style="background:#16a34a"></a>
      <a id="huaweiLink" class="btn" href="#" rel="nofollow" style="background:#ef4444"></a>
    </div>

    <div class="qr" id="qrWrap" style="display:none">
      <img id="qr" alt="QR" />
      <div>
        <div id="desktopTitle" style="font-weight:600"></div>
        <div id="desktopDesc"></div>
      </div>
    </div>

    <p class="hint"><span id="copyLead"></span> <code id="rawUrl"></code></p>
  </main>

  <script>
    // ====== 1) 替换为你的链接（必改） ======
    const IOS_APP_STORE       = "http://apple.co/2h4IJpO";
    const ANDROID_GOOGLE_PLAY = "https://play.google.com/store/apps/details?id=com.sunvy.poker.fans";
    const ANDROID_APK_FALLBACK = "https://static.pokerfans.jp/apks/PokerFans.apk"; // 可选：例如 https://cdn.example.com/app/latest.apk
    const HUAWEI_APPGALLERY    = ""; // 可选：例如 https://appgallery.huawei.com/app/C123456

    // ====== 2) 多语言 i18n（简/繁/英/日 + ?lang= 覆盖） ======
    function normalizeLang(tag) {
      if (!tag) return "en";
      const t = String(tag).toLowerCase();
      if (t.startsWith("ja")) return "ja";
      if (t.startsWith("en")) return "en";
      if (t.startsWith("zh")) {
        if (t.includes("hant") || t.endsWith("-tw") || t.endsWith("-hk") || t.endsWith("-mo"))
          return "zh-Hant";
        return "zh-Hans";
      }
      return "en";
    }
    const qs = new URLSearchParams(location.search);
    const forcedLang = qs.get("lang");
    let lang = forcedLang ? normalizeLang(forcedLang)
                          : normalizeLang((navigator.languages && navigator.languages[0]) || navigator.language);
    document.documentElement.lang = lang.startsWith("zh") ? (lang === "zh-Hant" ? "zh-Hant" : "zh-CN") : lang;

    const M = {
      "zh-Hans": {
        pageTitle: "正在为你跳转到应用商店…",
        title: "正在为你跳转到应用商店…",
        statusWeChat: "检测到微信内置浏览器，请点击下方按钮或在系统浏览器中打开以完成跳转。",
        statusIOS: "已检测到 iOS 设备，正在跳转到 App Store…",
        statusAndroid: "已检测到 Android 设备，正在跳转到 Google Play…",
        statusDesktop: "这是桌面端展示。请用手机访问或扫描二维码，或点击下方按钮手动前往商店。",
        statusFallback: "如未自动跳转，请点击下方按钮。",
        btnIOS: "前往 App Store（iOS）",
        btnAndroid: "前往 Google Play（Android）",
        hintAndroid: "提示：如 Android 设备无法使用 Google Play，可尝试备用下载。",
        btnAPK: "备用 APK 下载",
        btnHuawei: "华为 AppGallery",
        desktopTitle: "电脑上打开了这个页面？",
        desktopDesc: "用手机扫描二维码，直接跳转到商店。",
        copyLead: "若仍无法跳转，请手动复制打开：",
      },
      "zh-Hant": {
        pageTitle: "正在為你跳轉到應用程式商店…",
        title: "正在為你跳轉到應用程式商店…",
        statusWeChat: "偵測到微信內建瀏覽器，請點擊下方按鈕或以系統瀏覽器開啟完成跳轉。",
        statusIOS: "偵測到 iOS 裝置，正在跳轉到 App Store…",
        statusAndroid: "偵測到 Android 裝置，正在跳轉到 Google Play…",
        statusDesktop: "這是桌面端展示。請用手機開啟或掃描 QR code，或點擊下方按鈕前往商店。",
        statusFallback: "如未自動跳轉，請點擊下方按鈕。",
        btnIOS: "前往 App Store（iOS）",
        btnAndroid: "前往 Google Play（Android）",
        hintAndroid: "提示：若 Android 裝置無法使用 Google Play，可改用備用下載。",
        btnAPK: "備用 APK 下載",
        btnHuawei: "華為 AppGallery",
        desktopTitle: "在電腦上開啟了這個頁面？",
        desktopDesc: "請用手機掃描 QR code，直接跳轉到商店。",
        copyLead: "若仍無法跳轉，請手動複製開啟：",
      },
      "ja": {
        pageTitle: "アプリストアへ自動的に移動しています…",
        title: "アプリストアへ自動的に移動しています…",
        statusWeChat: "WeChat 内蔵ブラウザを検出しました。下のボタンを押すか、端末のブラウザで開いてください。",
        statusIOS: "iOS デバイスを検出しました。App Store へ移動します…",
        statusAndroid: "Android デバイスを検出しました。Google Play へ移動します…",
        statusDesktop: "PC で開いています。スマホでアクセスするか、QR を読み取るか、下のボタンを押してください。",
        statusFallback: "自動的に移動しない場合は、下のボタンを押してください。",
        btnIOS: "App Store を開く（iOS）",
        btnAndroid: "Google Play を開く（Android）",
        hintAndroid: "メモ：Google Play が使えない場合は、予備のダウンロードをご利用ください。",
        btnAPK: "APK をダウンロード（予備）",
        btnHuawei: "Huawei AppGallery",
        desktopTitle: "PC でこのページを開きましたか？",
        desktopDesc: "スマホで QR を読み取ると、ストアに直接移動します。",
        copyLead: "移動できない場合は、次の URL をコピーして開いてください：",
      },
      "en": {
        pageTitle: "Redirecting you to the app store…",
        title: "Redirecting you to the app store…",
        statusWeChat: "WeChat in-app browser detected. Tap the buttons below or open in your system browser.",
        statusIOS: "iOS device detected. Redirecting to the App Store…",
        statusAndroid: "Android device detected. Redirecting to Google Play…",
        statusDesktop: "You’re on desktop. Use your phone to visit or scan the QR, or click the buttons below.",
        statusFallback: "If you weren’t redirected, please use the buttons below.",
        btnIOS: "Open in App Store (iOS)",
        btnAndroid: "Open in Google Play (Android)",
        hintAndroid: "Tip: If Google Play is unavailable on your device, use the fallback download.",
        btnAPK: "Download APK (fallback)",
        btnHuawei: "Huawei AppGallery",
        desktopTitle: "Opened this page on desktop?",
        desktopDesc: "Scan the QR with your phone to go straight to the store.",
        copyLead: "If it still doesn’t work, copy and open:",
      }
    };
    const T = (k) => (M[lang] && M[lang][k]) || M.en[k] || k;

    // ====== 3) 透传 utm_* 参数到商店链接 ======
    function appendQuery(url, extra) {
      if (!url) return "";
      try {
        const u = new URL(url);
        if (extra) for (const [k, v] of extra.entries()) {
          if (/^(utm_|ref$|campaign$)/i.test(k)) u.searchParams.set(k, v);
        }
        return u.toString();
      } catch { return url; }
    }
    const incomingParams = new URLSearchParams(location.search);

    // ====== 4) 设备识别 ======
    const ua = navigator.userAgent || "";
    const uaData = navigator.userAgentData;
    const isAndroid = /Android/i.test(ua) || (uaData?.platform || "").toLowerCase().includes("android");
    const isIOS = /iPhone|iPad|iPod/i.test(ua) || (navigator.platform === "MacIntel" && navigator.maxTouchPoints > 1);
    const isMobile = isAndroid || isIOS;
    const isWeChat = /MicroMessenger/i.test(ua);
    const isDesktop = !isMobile;

    // ====== 5) 构建链接与赋文案 ======
    document.title = T("pageTitle");
    const iosHref = appendQuery(IOS_APP_STORE, incomingParams);
    const gpHref  = appendQuery(ANDROID_GOOGLE_PLAY, incomingParams);
    const apkHref = appendQuery(ANDROID_APK_FALLBACK, incomingParams);
    const huaHref = appendQuery(HUAWEI_APPGALLERY, incomingParams);

    const el = (id)=>document.getElementById(id);
    el("title").textContent = T("title");
    el("iosLink").textContent = T("btnIOS");
    el("androidLink").textContent = T("btnAndroid");
    el("hintAndroid").textContent = T("hintAndroid");
    el("desktopTitle").textContent = T("desktopTitle");
    el("desktopDesc").textContent = T("desktopDesc");
    el("copyLead").textContent = T("copyLead");

    el("iosLink").href = iosHref || "#";
    el("androidLink").href = gpHref || "#";
    el("rawUrl").textContent = location.href;

    if (apkHref || huaHref) {
      const wrap = el("extraBtns");
      wrap.style.display = "flex";
      const apk = el("androidApk");
      const hua = el("huaweiLink");
      if (apkHref) { apk.href = apkHref; apk.textContent = T("btnAPK"); } else apk.style.display = "none";
      if (huaHref) { hua.href = huaHref; hua.textContent = T("btnHuawei"); } else hua.style.display = "none";
    }

    // ====== 6) 桌面端生成简易占位 QR（生产可替换为真 QR） ======
    <script>
    // === 内置 QR 生成器（无需外网）：qrcode-generator (MIT, Kazuhiko Arase) ===
    // 源码裁剪自 https://github.com/kazuhikoarase/qrcode-generator ，仅保留必要方法。
    (function(){function l(a){this.mode=g.MODE_8BIT_BYTE;this.data=a}
    l.prototype={getLength:function(a){return this.data.length},write:function(a){for(var b=0;b<this.data.length;b++)a.put(this.data.charCodeAt(b),8)}};var g={};g.PAD0=236;g.PAD1=17;g.MODE_NUMBER=1;g.MODE_ALPHA_NUM=2;g.MODE_8BIT_BYTE=4;g.ErrorCorrectLevel={L:1,M:0,Q:3,H:2};
    function n(a,b){this.typeNumber=a;this.errorCorrectLevel=b;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}
    n.prototype={addData:function(a){this.dataList.push(new l(a));this.dataCache=null},isDark:function(a,b){if(this.modules[a][b]!==null)return this.modules[a][b];throw Error(a+","+b);},getModuleCount:function(){return this.moduleCount},make:function(){if(this.typeNumber<1)this.typeNumber=1;for(;this.typeNumber<=40;this.typeNumber++){if(this.makeImpl(!1,this.getBestMaskPattern()),this.dataCache!==null)break}},
    makeImpl:function(a,b){this.moduleCount=4*this.typeNumber+17;this.modules=Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++)this.modules[c][d]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(a,b);this.typeNumber>=7&&this.setupTypeNumber(a);
    this.dataCache=this.createData(this.typeNumber,this.errorCorrectLevel,this.dataList);this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;c<=7;c++)if(!(a+c<=-1||this.moduleCount<=a+c))for(var d=-1;d<=7;d++)b+d<=-1||this.moduleCount<=b+d||(this.modules[a+c][b+d]=0<=c&&c<=6&&(d==0||d==6)||0<=d&&d<=6&&(c==0||c==6)||2<=c&&c<=4&&2<=d&&d<=4)},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null===this.modules[a][6]&&(this.modules[a][6]=a%2==0),null===this.modules[6][a]&&(this.modules[6][a]=a%2==0)},
    setupPositionAdjustPattern:function(){for(var a=t.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null===this.modules[d][e])for(var f=-2;f<=2;f++)for(var h=-2;h<=2;h++)this.modules[d+f][e+h]=-2==f||2==f||-2==h||2==h||0==f&&0==h}},setupTypeNumber:function(a){for(var b=u.getBCHTypeNumber(this.typeNumber),c=0;c<18;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(c=0;c<18;c++)d=!a&&1==(b>>c&1),this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d},
    setupTypeInfo:function(a,b){for(var c=g.ErrorCorrectLevel,d=0;d<8;d++){var e=!a&&1==(u.getBCHTypeInfo(c[this.errorCorrectLevel]<<3|b)>>d&1);d<6&&(this.modules[d][8]=e);d<8&&(this.modules[8][this.moduleCount-1-d]=e);d<8&&(this.modules[this.moduleCount-1-d][8]=e);d<7&&(this.modules[8][d]=e)}this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,f=0,h=this.moduleCount-1;0<h;h-=2){6==h&&h--;for(;;){for(var k=0;k<2;k++)if(null===this.modules[d][h-k]){var m=!1;0<=f&&m===(1==a[f]>>e&1)||this.modules[d][h-k]=!m;e--; -1==e&&(f++,e=7)}d+=c;if(0>d||this.moduleCount<=d){d-=c;c=-c;break}}}},
    createData:function(a,b,c){for(var d=v.getRSBlocks(a,b),e=new w,f=0;f<c.length;f++){var h=c[f];e.put(h.mode,4);e.put(h.getLength(),x.getLengthInBits(h.mode,a));h.write(e)}for(f=0;f<d.length;f++)d[f].dataCount>e.getLengthInBits()/8&&e.put(0,4);for(;e.getLengthInBits()%8!=0;)e.putBit(!1);for(;!(e.getLengthInBits()/8>v.getMaxDataCount(d));){e.put(g.PAD0,8);if(e.getLengthInBits()/8>=v.getMaxDataCount(d))break;e.put(g.PAD1,8)}return y.createBytes(e,d)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;c<8;c++){this.makeImpl(!0,c);var d=z.getLostPoint(this);if(c==0||a>d)a=d,b=c}return b},
    createSvgTag:function(a){a=a||{};var b=a.cellSize||2,c=void 0===a.margin?4:a.margin,d=this.getModuleCount(),e=b*d+2*c,f=[];f.push('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"'+e+'\" height=\"'+e+'\" viewBox=\"0 0 '+e+' '+e+'\">');f.push('<rect width=\"100%\" height=\"100%\" fill=\"#fff\"/>');f.push('<path d=\"');for(var h=0;h<d;h++)for(var k=0;k<d;k++)this.isDark(h,k)&&f.push(\"M \"+(k*b+c)+\" \"+(h*b+c)+\" h \"+b+\" v \"+b+\" h -\"+b+\" Z \");f.push('\" fill=\"#000\"/></svg>');return f.join(\"\")}};
    var t={getPatternPosition:function(a){return C[a-1]||[]}},C=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],
    u={getBCHTypeInfo:function(a){for(var b=a<<10;u.getBCHDigit(b)-u.getBCHDigit(1335)>=0;)b^=1335<<u.getBCHDigit(b)-u.getBCHDigit(1335);return a<<10|b},getBCHTypeNumber:function(a){for(var b=a<<12;u.getBCHDigit(b)-u.getBCHDigit(7973)>=0;)b^=7973<<u.getBCHDigit(b)-u.getBCHDigit(7973);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b}};
    function w(){this.buffer=[];this.length=0}
    w.prototype={getBuffer:function(){return this.buffer},getLengthInBits:function(){return this.length},put:function(a,b){for(var c=0;c<b;c++)this.putBit((a>>b-c-1&1)==1)},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0);a&&(this.buffer[b]|=128>>>this.length%8);this.length++}};
    var x={getLengthInBits:function(a){return a==g.MODE_NUMBER?10:a==g.MODE_ALPHA_NUM?9:8}};
    var v={getRSBlocks:function(a,b){var c=B[4*(a-1)+[1,0,3,2][b]];for(var d=[],e=0;e<c.length/3;e++)for(var f=0;f<c[3*e+0];f++)d.push({dataCount:c[3*e+2],totalCount:c[3*e+1]});return d},getMaxDataCount:function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].dataCount;return b}},B=[1,26,19,1,26,16,1,26,13,1,26,9,1,44,34,1,44,28,1,44,22,1,44,16,1,70,55,1,70,44,2,35,17,2,35,13,1,100,80,2,50,32,2,50,24,4,25,9,1,134,108,2,67,43,2,33,15,2,33,11,2,86,68,4,43,27,4,43,19,4,43,15,2,98,78,4,49,31,2,32,14,4,39,13,2,121,97,2,60,38,4,40,18,4,40,14,2,146,116,3,58,36,4,36,16,4,36,12,2,86,68,4,69,43,6,43,19,6,43,15,4,101,81,1,80,50,4,50,22,3,36,12,2,116,92,6,58,36,4,46,20,7,42,14,4,133,107,8,59,37,8,44,20,12,33,11,3,145,115,4,64,40,11,36,16,11,36,12,5,109,87,5,65,41,5,54,24,11,36,12,5,122,98,7,73,45,15,43,19,3,45,15,1,135,107,10,74,46,1,50,22,2,42,14,5,150,120,9,69,43,17,50,22,2,42,14,3,141,113,3,70,44,9,43,19,3,45,15,3,135,107,3,67,41,15,54,24,15,36,12,4,144,116,17,68,42,17,50,22,19,46,16,2,139,111,17,74,46,7,54,24,34,37,13,4,151,121,4,75,47,11,54,24,16,45,15,6,147,117,6,73,45,19,54,24,30,46,16,8,132,106,8,75,47,22,45,15,22,45,15];
    var y={getErrorCorrectPolynomial:function(a){for(var b=new A([1],0),c=0;c<a;c++)b=b.multiply(new A([1,tb.gexp(c)],0));return b},createBytes:function(a,b){for(var c=0,d=0;d<b.length;d++)c=Math.max(c,b[d].dataCount);for(var e=Array(c),f=0;f<c;f++)e[f]=[];for(d=0;d<b.length;d++){var h=b[d].dataCount;for(f=0;f<h;f++)e[f].push(a.getBuffer()[f])}for(d=0;d<b.length;d++)for(f=b[d].dataCount;f<b[d].totalCount;f++)e[f-(b[d].totalCount-b[d].dataCount)].push(0);for(var k=[],m=0;m<e.length;m++)for(f=0;f<e[m].length;f++)k.push(e[m][f]);return k}};
    function A(a,b){this.num=a;this.shift=b}
    A.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var d=0;d<a.getLength();d++)b[c+d]^=tb.gmul(this.get(c),a.get(d));return new A(b,this.shift+a.shift)}};
    var tb={gexp:function(a){for(;a<0;)a+=255;for(;a>=256;)a-=255;return D[a]},glog:function(a){if(1>a)throw Error("glog("+a+")");return E[a]},gmul:function(a,b){return 0==a||0==b?0:D[(E[a]+E[b])%255]}};for(var D=Array(256),E=Array(256),F=1,G=0;256>G;G++)D[G]=F,F<<=1,256<=F&&(F^=285),E[D[G]]=G;var z={getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var e=0;e<b;e++){for(var f=0,h=a.isDark(d,e),k=-1;k<=1;k++)if(!(d+k<0||b<=d+k))for(var m=-1;m<=1;m++)e+m<0||b<=e+m||0==k&&0==m||h==a.isDark(d+k,e+m)&&f++;f>5&&(c+=3+f-5)}for(d=0;d<b-1;d++)for(e=0;e<b-1;e++){f=0;a.isDark(d,e)&&f++;a.isDark(d+1,e)&&f++;a.isDark(d,e+1)&&f++;a.isDark(d+1,e+1)&&f++;0!=f&&4!=f||(c+=3)}for(d=0;d<b;d++)for(e=0;e<b-6;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(e=0;e<b;e++){for(f=0,d=0;d<b;d++)a.isDark(d,e)&&f++;c+=10*(Math.abs(f-b/2)/b*20)}return c}};window.qrcode=function(a,b){return new n(a||0,g.ErrorCorrectLevel[b||'M'])};})();
    </script>
    // 生成并渲染 SVG QR（内容=当前页 URL）
    function renderInlineQR() {
    const text = location.href;          // 也可以改成 iosHref/gpHref 等
    const qr = qrcode(0, 'Q');           // 自动选择版本，错误校正 Q（较高冗余）
    qr.addData(text);
    qr.make();
    const svgTag = qr.createSvgTag({ cellSize: 4, margin: 2 }); // 120~200px 级别清晰
    const dataUrl = 'data:image/svg+xml;utf8,' + encodeURIComponent(svgTag);
    el("qr").src = dataUrl;
    el("qrWrap").style.display = "flex";
    }
    if (isDesktop) renderInlineQR();

    // ====== 7) 自动跳转与状态文案 ======
    const status = el("status");
    const go = (url) => url && location.replace(url);

    if (isWeChat) {
      status.textContent = T("statusWeChat");
    } else if (isIOS && iosHref) {
      status.textContent = T("statusIOS");
      setTimeout(() => go(iosHref), 200);
    } else if (isAndroid && gpHref) {
      status.textContent = T("statusAndroid");
      setTimeout(() => go(gpHref), 200);
    } else {
      status.textContent = T("statusDesktop");
    }

    // 兜底：2 秒未离开则改提示
    let jumped = false;
    addEventListener("pagehide", () => jumped = true);
    setTimeout(() => { if (!jumped) status.textContent = T("statusFallback"); }, 2000);
  </script>
</body>
</html>
